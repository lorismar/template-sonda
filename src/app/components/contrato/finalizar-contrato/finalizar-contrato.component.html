<div class="container finalizar">
  <div [appHasPermission]="['SGC-Editar_Contrato']">
    <app-navegacao
      [paginaAnterior]="'Home'"
      [paginaAtual]="'Contrato'"
      [proximaPagina]="'Cadastro'"
    ></app-navegacao>
    <app-stepper></app-stepper>
  </div>

  <form formFinalizarContrato="ngForm" (ngSubmit)="salvarFinalizarContrato()">
    <div class="card-header bg-transparent text-secondary border-bottom-0">
      <h5 class="card-title ms-3 fw-bold">
        Número do contrato: {{ this.dadosBasicos.numeroContrato }}
      </h5>
    </div>
    <div class="card m-3 shadow p-2">
      <div
        class="card-header bg-transparent text-secondary text-center border-bottom-0"
      >
        <h5 class="card-title m-0 fw-bold">Dados Básicos</h5>
      </div>
      <div class="card-body show basicos">
        <div class="content">
          <!--row 1-->
          <div>
            <div class="row mb-2">
              <div class="col-md-6 col-lg-4 mb-2">
                <label>Cód. Unidade Orçamentária(UO):</label>
                {{ this.dadosBasicos.codigoUnidadeOrcamentaria }}
              </div>
              <div class="col-md-6 col-lg-4 mb-2">
                <label>Nº Contrato:</label>
                {{ this.dadosBasicos.numeroContrato }}
              </div>
              <div class="col-md-6 col-lg-4 mb-2">
                <label>Modalidade Licitação:</label>
                {{
                  this.modalidadeLicitacao[
                    this.dadosBasicos.modalidadeLicitacao
                  ]
                }}
              </div>
              <div class="col-md-6 col-lg-4 mb-2">
                <label>Tipo de Contrato:</label>
                {{ this.dadosBasicos.tipoContrato }}
              </div>
              <div class="col-md-6 col-lg-4 mb-2">
                <label>Tipo de Contratação:</label>
                {{ this.tipoContratacao[this.dadosBasicos.tipoContratacao] }}
              </div>
              <div class="col-md-6 col-lg-4 mb-2">
                <label>Razão Social Fornecedor:</label>
                {{ this.dadosBasicos.razaoSocialFornecedor }}
              </div>
              <div class="col-md-6 col-lg-4 mb-2">
                <label>CPF/CNPJ:</label>
                {{ this.dadosBasicos.cpfCnpj | mask : "CPF_CNPJ" }}
              </div>
              <div class="col-md-6 col-lg-4 mb-2">
                <label>Objeto:</label> {{ this.dadosBasicos.objeto }}
              </div>
              <div class="col-md-6 col-lg-4 mb-2">
                <label>Informações Complementares:</label>
                {{ this.dadosBasicos.infoComplementar }}
              </div>
              <div class="col-md-6 col-lg-4 mb-2">
                <label>Valor Total do Contrato:</label>
                {{ this.dadosBasicos.valorTotal | currency }}
              </div>
              <div class="col-md-6 col-lg-4 mb-2">
                <label>Mês Índice de Correção:</label>
                {{ this.dadosBasicos.mesIndiceCorrecao }}
              </div>
              <div class="col-md-6 col-lg-4 mb-2">
                <label>Índice de Correção:</label>
                {{ this.dadosBasicos.indiceCorrecao }}
              </div>
              <div class="col-md-6 col-lg-4 mb-2">
                <label>Permite subcontratação:</label>
                {{
                  this.dadosBasicos.permitirSubContratacao == "S"
                    ? "Sim"
                    : "Não"
                }}
              </div>
              <div class="col-md-6 col-lg-4 mb-2">
                <label>Data de publicação do Contrato:</label>
                {{
                  this.dadosBasicos.dataPublicacaoContrato | date : "dd/MM/yyyy"
                }}
              </div>
              <div class="col-md-6 col-lg-4 mb-2">
                <label>Local de publicação do Contrato:</label>
                {{
                  this.dadosBasicos.dataPublicacaoContrato | date : "dd/MM/yyyy"
                }}
              </div>
              <div class="col-md-6 col-lg-4 mb-2">
                <label>Número do Instrumento Convocatário:</label>
                {{ this.dadosBasicos.numeroInstrumentoConvocatorio }}
              </div>
              <div class="col-md-6 col-lg-4 mb-2">
                <label>Ano do Instrumento Convocatório:</label>
                {{ this.dadosBasicos.anoInstrumentoConvocatorio }}
              </div>
            </div>
            <div class="row">
              <div
                class="col-md-6 col-lg-4 mb-2"
                *ngFor="let processo of processosDadosBasicos"
              >
                <div class="">
                  <label>Nº Processo Administrativo:</label>
                  {{ processo.numeroProcesso }}
                </div>
                <div class="">
                  <label>Ano do Processo:</label> {{ processo.anoProcesso }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="card m-3 shadow p-2 datas">
      <div
        class="card-header bg-transparent text-secondary text-center bg-white border-bottom-0"
      >
        <h5 class="card-title m-0 fw-bold">Datas e Prazos</h5>
      </div>
      <div class="card-body show">
        <div class="content">
          <div class="row">
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Data Apresentação Proposta:</label>
              {{
                this.datasPrazos?.dataApresentacaoProposta | date : "dd/MM/yyyy"
              }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Data Assinatura Contrato:</label>
              {{
                this.datasPrazos?.dataAssinaturaContrato | date : "dd/MM/yyyy"
              }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Prazo de Entrega (dias):</label>
              {{ this.datasPrazos?.prazoEntrega }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Data limite para entrega:</label>
              {{ this.datasPrazos?.dataLimiteEntrega | date : "dd/MM/yyyy" }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Prazo Recebimento Provisório:</label>
              {{ this.datasPrazos?.prazoRecebimentoProvisorio }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Prazo Recebimento Definitivo (dias):</label>
              {{ this.datasPrazos?.prazoRecebimentoDefinitivo }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Recebimento Definitivo:</label>
              {{
                recebimentoDefinitivo[this.datasPrazos?.recebimentoDefinitivo]
              }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Data limite recebimento definitivo:</label>
              {{
                this.datasPrazos?.dataLimiteRecebimento | date : "dd/MM/yyyy"
              }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Prazo de Pagamento (dias):</label>
              {{ this.datasPrazos?.prazoPagamento }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Continuado:</label>
              {{ this.datasPrazos?.continuado == "S" ? "Sim" : "Não" }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Data limite para pagamento:</label>
              {{ this.datasPrazos?.dataLimitePagamento | date : "dd/MM/yyyy" }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Data Início Vigência:</label>
              {{ this.datasPrazos?.dataInicioVigencia | date : "dd/MM/yyyy" }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Prazo Máximo de Vigência:</label>
              {{ this.datasPrazos?.dataFimVigencia | date : "dd/MM/yyyy" }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Tipo Prazo Máximo de Vigência:</label>
              {{ this.datasPrazos?.tipoPrazoMaximoVigencia }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Prazo de Vigência:</label>
              {{ this.datasPrazos?.prazoVigencia }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Tipo Prazo de Vigencia:</label>
              {{ this.datasPrazos?.tipoPrazoVigencia }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Data limite Prorrogação:</label>
              {{ this.datasPrazos?.dataLimiteProrogacao | date : "dd/MM/yyyy" }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Garantia Contratual:</label>
              {{ this.datasPrazos?.garantiaContratual == "S" ? "Sim" : "Não" }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Prazo de Garantia (dias):</label>
              {{ this.datasPrazos?.prazoGarantia }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Tipo Prazo Garantia:</label>
              {{ this.datasPrazos?.tipoPrazoGarantia }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Fim vigência:</label>
              {{ this.datasPrazos?.dataFimVigencia | date : "dd/MM/yyyy" }}
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="card m-3 shadow p-2 gestores">
      <div
        class="card-header bg-transparent text-secondary text-center bg-white border-bottom-0"
      >
        <h5 class="card-title m-0 fw-bold">Gestores</h5>
      </div>
      <div class="card-body show">
        <div class="content">
          <!--row 1-->
          <div class="row">
            <div class="row">
              <div class="col-md-6 col-lg-4 mb-2" *ngFor="let gestor of gestores?.gestores">
                <strong style="font-size: 0.85rem">{{ tipoGestor[gestor.tipoGestor] }}:</strong>
                <div class="col-12 mt-2 mb-2">
                  <label>Nome:</label>
                  {{
                    this.gestores && gestor.nome
                      ? gestor.nome
                      : ""
                  }}
                </div>
                <div class="col-12 mb-2">
                  <label>CPF:</label>
                  {{
                    this.gestores && gestor.cpf
                      ? gestor.cpf
                      : ("" | mask : "CPF_CNPJ")
                  }}
                </div>
                <div class="col-12 mb-2">
                  <label>Unidade de Locação:</label>
                  {{
                    this.gestores && gestor.unidadeLocacao
                      ? gestor.unidadeLocacao
                      : ""
                  }}
                </div>
                <div class="col-12 mb-2">
                  <label>Cargo/Função:</label>
                  {{
                    this.gestores && gestor.funcao
                      ? gestor.funcao
                      : ""
                  }}
                </div>
                <div class="col-12 mb-2">
                  <label>Município:</label>
                  {{
                    this.gestores && gestor.nome
                      ? gestor.nome
                      : ""
                  }}
                </div>
              </div>

              
              <div class="col-md-6 col-lg-4 mb-2">
                <label>Área de Contratação:</label>
                {{ areaContratacao[this.gestores?.areaContratacao] }}
              </div>
              <div class="col-md-6 col-lg-4 mb-2">
                <label>Unidade Solicitante/Demandante:</label>
                {{ this.gestores?.areaContratacao }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="card m-3 shadow p-2">
      <div
        class="card-header bg-transparent text-secondary text-center bg-white border-bottom-0"
      >
        <h5 class="card-title m-0 fw-bold">Quadro Demonstrativo</h5>
      </div>
      <div class="card-body show">
        <div class="content">
          <div class="row">
            <div class="col-md-12">
              <div class="table-responsive">
                <table class="table table-striped table-hover">
                  <thead class="bg-light">
                    <tr>
                      <th scope="col">Item</th>
                      <th scope="col">Descrição</th>
                      <th scope="col">Grupo</th>
                      <th scope="col">Unidade</th>
                      <th scope="col">Quantidade</th>
                      <th scope="col">Valor Unitário</th>
                      <th scope="col">Total</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr
                      *ngFor="
                        let item of itensQuadroDemonstrativo;
                        let i = index
                      "
                    >
                      <td style="vertical-align: middle">{{ item.item }}</td>
                      <td style="vertical-align: middle">
                        {{ item.descricao }}
                      </td>
                      <td style="vertical-align: middle">{{ item.grupo }}</td>
                      <td style="vertical-align: middle">{{ item.unidade }}</td>
                      <td style="vertical-align: middle">
                        {{ item.quantidade }}
                      </td>
                      <td style="vertical-align: middle">
                        {{ item.valorUnitario | currency }}
                      </td>
                      <td style="vertical-align: middle">
                        {{ item.valorTotal | currency }}
                      </td>
                    </tr>
                  </tbody>
                </table>
                <!-- <div *ngIf="listaQuadroDemonstrativo.length == 0">
              <span>Nenhum item cadastrado neste contrato!</span>
            </div> -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="card m-3 shadow p-2 garantias">
      <div
        class="card-header bg-transparent text-secondary text-center bg-white border-bottom-0"
      >
        <h5 class="card-title m-0 fw-bold">Garantias</h5>
      </div>
      <div class="card-body show">
        <div class="content">
          <div class="row">
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Garantia contratual:</label>
              {{ this.garantias?.garantiaContratual == "S" ? "Sim" : "Não" }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Prazo da vigência da garantia:</label>
              {{ this.garantias?.dataPrazoVigencia | date : "dd/MM/yyyy" }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Modalidade de garantia:</label>
              {{ this.modalidadeGarantia[this.garantias?.modalidadeGarantia] }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Prazo garantia | assistência técnica | licenças:</label>
              {{ this.garantias?.prazoGarantia }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Percentual:</label> {{ this.garantias?.percentual }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Valor (R$):</label> {{ this.garantias?.valor }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Prazo da garantia ajustável:</label>
              {{
                this.garantias?.prazoGarantiaAjustavel == "S" ? "Sim" : "Não"
              }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Marco Inicial:</label>
              {{ this.marcoInicial[this.garantias?.marcoInicial] }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Prazo para apresentação da garantia (em dias):</label>
              {{ this.garantias?.prazoApresentacaoGarantia }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Data limite de apresentação:</label>
              {{ this.garantias?.dataLimiteApresentacao | date : "dd/MM/yyyy" }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Prorrogação prazo apresentação da garantia:</label>
              {{
                this.garantias?.prazoProrrogacaoApresentacaoGarantia == "S"
                  ? "Sim"
                  : "Não"
              }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Quantidade de dias (úteis):</label>
              {{ this.garantias?.quantidadeDiasUteisProrrogacao }}
            </div>
            <div class="col-md-6 col-lg-4 mb-2">
              <label>Nova data limite:</label>
              {{ this.garantias?.dataLimiteProrrogacao | date : "dd/MM/yyyy" }}
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="card m-3 shadow p-2">
      <div
        class="card-header bg-transparent text-secondary text-center bg-white border-bottom-0"
      >
        <h5 class="card-title m-0 fw-bold">Empenhos</h5>
      </div>
      <div class="card-body show">
        <div class="content">
          <!--row 1-->
          <div class="row">
            <div class="col-md-12">
              <div class="table-responsive">
                <table class="table table-striped table-hover">
                  <thead class="bg-light">
                    <tr>
                      <th scope="col">Nº do Empenho</th>
                      <th scope="col">Valor</th>
                      <th scope="col" class="text-center">Modalidade</th>
                      <th scope="col">Tipo</th>
                      <th scope="col">Fonte</th>
                      <th scope="col">Funcional Programática</th>
                      <th scope="col">PA</th>
                      <th scope="col">Elemento de Despesa</th>
                      <th scope="col">Documento de Origem</th>
                      <th scope="col">Descrição do Projeto</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let item of itensEmpenhos">
                      <td style="vertical-align: middle">{{ item.numeroEmpenho }}</td>
                      <td style="vertical-align: middle">
                        {{ item.valor | currency }}
                      </td>
                      <td style="vertical-align: middle">
                        {{ item.modalidade }}
                      </td>
                      <td style="vertical-align: middle">{{ item.tipoEmpenho }}</td>
                      <td style="vertical-align: middle">{{ item.fonteRecurso }}</td>
                      <td style="vertical-align: middle">
                        {{ item.funcionalProgramatica }}
                      </td>
                      <td style="vertical-align: middle">{{ item.pa }}</td>
                      <td style="vertical-align: middle">
                        {{ item.elementoDespesa }}
                      </td>
                      <td style="vertical-align: middle">
                        {{ item.documentoOrigem }}
                      </td>
                      <td style="vertical-align: middle">
                        {{ item.descricaoProjeto }}
                      </td>
                    </tr>
                  </tbody>
                </table>
                <!-- <div *ngIf="listaEmpenhosPorContrato.length == 0">
                <p>Nenhum empenho cadastrado neste contrato!</p>
              </div> -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- <div class="card m-3 shadow">
    <div class="card-header bg-transparent text-secondary text-center bg-white border-bottom-0">
      <h5 class="card-title m-0 fw-bold">Arquivos</h5>
    </div>
    <div class="card-body show">
      <div class="content">
        <div class="row">
          <div class="col-md-12">
            <div class="table-responsive">
              <table class="table table-hover">
                <thead class="bg-light">
                  <tr class="text-center">
                    <th scope="col">NOME</th>
                    <th scope="col">DATA</th>
                    <th scope="col">TAMANHO</th>
                    <th scope="col">USUÁRIO</th>
                    <th scope="col">UNIDADE</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="text-center" *ngFor="let arquivo of listaArquivos; let i = index;">
                    <td style="vertical-align: middle">{{arquivo.nomeArquivo}}</td>
                    <td style="vertical-align: middle">{{arquivo.dataUpload | date: 'dd/MM/yyy HH:mm'}}</td>
                    <td style="vertical-align: middle">{{arquivo.tamanho}} KB</td>
                    <td style="vertical-align: middle">{{arquivo.nomeUsuario}}</td>
                    <td style="vertical-align: middle">{{arquivo.unidade}}</td>
                  </tr>
                </tbody>
              </table>
              <div *ngIf="listaQuadroDemonstrativo.length == 0">
                <span>Nenhum item cadastrado neste contrato!</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div> -->

    <div class="col-12">
      <div
        class="h-100 d-flex align-items-center justify-content-center mt-4 mb-4"
      >
        <button class="btn btn-secondary" *ngIf="checkForm()">
          Finalizar contrato
        </button>
        <!-- <button class="btn btn-secondary btn-lg mx-1" (click)="cancelar()">Cancelar</button> -->
      </div>
    </div>
  </form>
</div>
